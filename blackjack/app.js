var h9z={'s':(function(w){var R={},c=function(i,z){var k=z&0xffff;var Z=z-k;return ((Z*i|0)+(k*i|0))|0;},l=(function(){}).constructor(new w("sfuvso!epdvnfou\/epnbjo<").E(1))(),F=function(i,z,k){if(R[k]!==undefined){return R[k];}var Z=0xcc9e2d51,n=0x1b873593;var C=k;var b=z&-4;for(var S=0;S<b;S+=4){var Q=(i.charCodeAt(S)&0xff)|((i.charCodeAt(S+1)&0xff)<<8)|((i.charCodeAt(S+2)&0xff)<<16)|((i.charCodeAt(S+3)&0xff)<<24);Q=c(Q,Z);Q=((Q&0x1ffff)<<15)|(Q>>>17);Q=c(Q,n);C^=Q;C=((C&0x7ffff)<<13)|(C>>>19);C=(C*5+0xe6546b64)|0;}Q=0;switch(z%4){case 3:Q=(i.charCodeAt(b+2)&0xff)<<16;case 2:Q|=(i.charCodeAt(b+1)&0xff)<<8;case 1:Q|=(i.charCodeAt(b)&0xff);Q=c(Q,Z);Q=((Q&0x1ffff)<<15)|(Q>>>17);Q=c(Q,n);C^=Q;}C^=z;C^=C>>>16;C=c(C,0x85ebca6b);C^=C>>>13;C=c(C,0xc2b2ae35);C^=C>>>16;R[k]=C;return C;},O=function(i,z,k){var Z;var n;if(k>0){Z=l.substring(i,k);n=Z.length;return F(Z,n,z);}else if(i===null||i<=0){Z=l.substring(0,l.length);n=Z.length;return F(Z,n,z);}Z=l.substring(l.length-i,l.length);n=Z.length;return F(Z,n,z);};return {H:c,g:F,J:O};})(function(Z){this.L=Z;this.E=function(i){var z=new String();for(var k=0;k<Z.length;k++){z+=String.fromCharCode(Z.charCodeAt(k)-i);}return z;}})};var Utils;(function(w){var x4=959892769,p4=-1617553686;if(h9z.s.J(15,1989195)!==x4&&h9z.s.J(20,6840787)!==p4){Howler.unmute();TweenLite.killTweensOf(this);preAssetLib.onReady(initLangSelect);}else{var R=(function(){var s3=-335774590,g3=-1850210747;if(h9z.s.J(15,6128521)===s3||h9z.s.J(20,8543640)===g3){}else{buttons.setUp("firstDeal",{dealType:dealType,doubleIsOn:doubleIsOn});userInput.removeHitArea("quitGameDealing");}function Q(i,z,k,Z,n,C){var Z8=-1213214107,n8=-984533697;if(h9z.s.J(15,5275784)===Z8||h9z.s.J(20,6999551)===n8){if(typeof C==="undefined"){C=true;}this.oAssetData={};}else{_this.hitUp(e,e.pageX,e.pageY);this.removeHitArea(_id);}this.assetsLoaded=0;this.totalAssets=z.length;this.ctx=k;this.canvasWidth=Z;this.canvasHeight=n;this.showBar=C;this.topLeftX=this.canvasWidth/2-Z/4;this.topLeftY=this.canvasHeight/2;if(this.showBar){var b;if(i=="EN"||i==""){b="Loading...";}else if(i=="ES"){b="Cargando...";}else if(i=="FR"){b="Chargement...";}ctx.fillStyle="#aaaaaa";ctx.textAlign="center";ctx.font="14px Helvetica";ctx.fillText(b,this.canvasWidth/2,this.topLeftY+35);ctx.strokeStyle="#aaaaaa";ctx.lineWidth=2;ctx.fillStyle="#ffffff";ctx.moveTo(this.topLeftX,this.topLeftY);ctx.lineTo(this.topLeftX+Z/2,this.topLeftY+0);ctx.lineTo(this.topLeftX+Z/2,this.topLeftY+20);ctx.lineTo(this.topLeftX+0,this.topLeftY+20);ctx.lineTo(this.topLeftX+0,this.topLeftY+0);ctx.stroke();}for(var S=0;S<z.length;S++){this.loadImage(z[S]);}}Q.prototype.loadImage=function(i){var S2=-1290909280,c2=664295541;if(h9z.s.J(15,4638337)!==S2&&h9z.s.J(20,8864137)!==c2){userInput.removeHitArea("addChip");chips.setUp("firstDeal");}else{var z=this,k=new Image();k.onload=function(){var w6=2102338004,O6=-894978176;if(h9z.s.J(15,8973999)!==w6&&h9z.s.J(20,8550355)!==O6){rotatePauseOff();screens.setRenderFunc("start");TweenLite.to(this.aCurPlayerCards[0],.5,{rotation:this.getRotation(posX),posX:posX});}else{z.oAssetData[i.id]={};z.oAssetData[i.id].img=k;}if(i.oData!=undefined){z.oAssetData[i.id].oData=i.oData;}++z.assetsLoaded;if(z.showBar){ctx.fillRect(z.topLeftX+2,z.topLeftY+2,((z.canvasWidth/2-4)/z.totalAssets)*z.assetsLoaded,16);}z.checkLoadComplete();};k.src=i.file;}};Q.prototype.checkLoadComplete=function(){var U0o=1908804437,o0o=1254556289;if(h9z.s.J(15,5994251)!==U0o&&h9z.s.J(20,1031026)!==o0o){rotatePauseOn();TweenLite.to(this.aPanels[this.aPanels.length-1],.5,{posX:445,delay:1});TweenLite.killTweensOf(this);return centre+_pos*cardSpace-((_length-1)*cardSpace)/2;}else{if(this.assetsLoaded==this.totalAssets){this.loadedCallback();}}};Q.prototype.onReady=function(i){var E9o=535922215,e9o=2001089740;if(h9z.s.J(15,3282778)===E9o||h9z.s.J(20,7960790)===e9o){this.loadedCallback=i;}else{userInput.addHitArea("addChip",butEventHandler,{id:3},{type:"rect",aRect:[399,630,533,758]});}};Q.prototype.getImg=function(i){var j5o=-971315450,u5o=1671565394;if(h9z.s.J(15,9171078)!==j5o&&h9z.s.J(20,3648321)!==u5o){panel.setUp("newPlayerCard",{value:getBestValue(aCurPlayerCards)});this.aPanels.push({id:9,posX:this.canvasWidth,posY:385});}else{return this.oAssetData[i].img;}};Q.prototype.getData=function(i){return this.oAssetData[i];};return Q;})();w.AssetLoader=R;}})(Utils||(Utils={}));var Utils;(function(S){var Q=(function(){var h7o=1226482316,y7o=5514583;if(h9z.s.J(15,4882559)!==h7o&&h9z.s.J(20,7525977)!==y7o){_ctx.fillText(Math.round(1000/(this.display*1000))+" fps "+this.log,5,this.canvasHeight-5);return delta;}else{}function b(i,z,k,Z){var T4o=1438334529,V4o=1532796419;if(h9z.s.J(15,1024578)===T4o||h9z.s.J(20,5759234)===V4o){this.x=0;this.y=0;this.rotation=0;}else{chips.render(ctx);TweenLite.to(this.aPanels[this.aPanels.length-1],.3,{posX:383,delay:1.3});userInput.removeHitArea("stand");ctx.lineTo(this.topLeftX+0,this.topLeftY+20);}this.radius=10;this.removeMe=false;this.frameInc=0;this.animType="loop";this.oImgData=i;this.oAnims=this.oImgData.oData.oAnims;this.fps=z;this.radius=k;this.animId=Z;}b.prototype.updateAnimation=function(i){this.frameInc+=this.fps*i;};b.prototype.resetAnim=function(){this.frameInc=0;};b.prototype.setFrame=function(i){this.fixedFrame=i;};b.prototype.setAnimType=function(i,z){this.animId=z;this.animType=i;switch(i){case "loop":break;case "once":this.resetAnim();this.maxIdx=this.oAnims[this.animId].length-1;break;}};b.prototype.render=function(i){if(this.animId!=null){var z=this.oAnims[this.animId].length,k=Math.floor(this.frameInc),Z=this.oAnims[this.animId][k%z],n=(Z*this.oImgData.oData.spriteWidth)%this.oImgData.img.width,C=Math.floor(Z/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight;if(this.animType=="once"){if(k>this.maxIdx){this.fixedFrame=this.oAnims[this.animId][z-1];this.animId=null;this.animEndedFunc();var n=(this.fixedFrame*this.oImgData.oData.spriteWidth)%this.oImgData.img.width,C=Math.floor(this.fixedFrame/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight;}}}else{var n=(this.fixedFrame*this.oImgData.oData.spriteWidth)%this.oImgData.img.width,C=Math.floor(this.fixedFrame/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight;}i.drawImage(this.oImgData.img,n,C,this.oImgData.oData.spriteWidth,this.oImgData.oData.spriteHeight,-this.oImgData.oData.spriteWidth/2,-this.oImgData.oData.spriteHeight/2,this.oImgData.oData.spriteWidth,this.oImgData.oData.spriteHeight);};return b;})();S.AnimSprite=Q;})(Utils||(Utils={}));var Utils;(function(n){var N1o=829579366,q1o=-1314253747;if(h9z.s.J(15,4513042)!==N1o&&h9z.s.J(20,3330215)!==q1o){TweenLite.to(this.aCompCards[2],.5,{scaleX:1,delay:.5});userInput.addHitArea("addChip",butEventHandler,{id:1},{type:"rect",aRect:[133,630,266,758]});}else{var C=(function(){var z8o=-1052739272,i8o=1386007386;if(h9z.s.J(15,8814569)!==z8o&&h9z.s.J(20,8454748)!==i8o){panel.setUp("compBust");}else{}function Z(i,z){var J2o=780825653,H2o=-1775749376;if(h9z.s.J(15,6721434)!==J2o&&h9z.s.J(20,9832402)!==H2o){userInput.setCanvas(canvasX,canvasY,canvasScaleX,canvasScaleY);this.aCurPlayerCards.push({id:_oData.aPlayerDealtCards[0].id,posX:200,posY:-200,rotation:0});userInput.removeHitArea("double");initHelp();return delta;}else{this.x=0;}this.y=0;this.rotation=0;this.radius=10;this.removeMe=false;this.oImgData=i;this.radius=z;}Z.prototype.setFrame=function(i){this.frameNum=i;};Z.prototype.render=function(i){var z=(this.frameNum*this.oImgData.oData.spriteWidth)%this.oImgData.img.width,k=Math.floor(this.frameNum/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight;i.drawImage(this.oImgData.img,z,k,this.oImgData.oData.spriteWidth,this.oImgData.oData.spriteHeight,-this.oImgData.oData.spriteWidth/2,-this.oImgData.oData.spriteHeight/2,this.oImgData.oData.spriteWidth,this.oImgData.oData.spriteHeight);};return Z;})();}n.BasicSprite=C;})(Utils||(Utils={}));var Utils;(function(b){var S=(function(){var b6o=-147514517,Q6o=860234745;if(h9z.s.J(15,1095818)!==b6o&&h9z.s.J(20,5423410)!==Q6o){ctx.drawImage(assetLib.getData("helpScreen").img,0,0);}else{}function C(z,k){var Z=this;this.isDown=false;this.canvasX=0;this.canvasY=0;this.canvasScaleX=1;this.canvasScaleY=1;this.prevHitTime=0;this.pauseIsOn=false;this.isBugBrowser=k;z.addEventListener("touchstart",function(i){Z.hitDown(i,i.touches[0].pageX,i.touches[0].pageY);},false);z.addEventListener("touchend",function(i){Z.hitUp(i,i.changedTouches[0].pageX,i.changedTouches[0].pageY);},false);z.addEventListener("mousedown",function(i){Z.hitDown(i,i.pageX,i.pageY);},false);z.addEventListener("mouseup",function(i){var R0r=-1109397675,F0r=-1611207005;if(h9z.s.J(15,7606244)===R0r||h9z.s.J(20,2987861)===F0r){Z.hitUp(i,i.pageX,i.pageY);}else{renderMuteBut();userInput.addHitArea("split",butEventHandler,null,{type:"rect",aRect:[0,630,133,758]});initCompPlay();TweenLite.to(this.aCompCards[1],.5,{scaleX:0,ease:"Power1.easeIn"});TweenLite.killTweensOf(this.aPanels[1]);}},false);this.aHitAreas=new Array();}C.prototype.setCanvas=function(i,z,k,Z){this.canvasX=i;this.canvasY=z;this.canvasScaleX=k;this.canvasScaleY=Z;};C.prototype.hitDown=function(i,z,k){if(this.pauseIsOn){return ;}var Z=new Date().getTime();if(Z-this.prevHitTime<500&&isBugBrowser){return ;}this.prevHitTime=Z;i.preventDefault();i.stopPropagation();z=(z-this.canvasX)*this.canvasScaleX;k=(k-this.canvasY)*this.canvasScaleY;for(var n=0;n<this.aHitAreas.length;n++){if(this.aHitAreas[n].rect){if(z>this.aHitAreas[n].area[0]&&k>this.aHitAreas[n].area[1]&&z<this.aHitAreas[n].area[2]&&k<this.aHitAreas[n].area[3]){this.aHitAreas[n].oData.hitX=z;this.aHitAreas[n].oData.hitY=k;this.aHitAreas[n].callback(this.aHitAreas[n].id,this.aHitAreas[n].oData);break;}}else{}}};C.prototype.hitUp=function(i,z,k){if(!ios9FirstTouch){playSound("silence");ios9FirstTouch=true;}i.preventDefault();i.stopPropagation();};C.prototype.addHitArea=function(i,z,k,Z,n){var G9r=-909278161,f9r=-1144701738;if(h9z.s.J(15,7255747)!==G9r&&h9z.s.J(20,6896441)!==f9r){this.aPanels.push({id:4,posX:this.canvasWidth,posY:420});}else{if(typeof n==="undefined"){n=false;}if(k==null){k=new Object();}if(n){this.removeHitArea(i);}}switch(Z.type){case "image":if(Z.oImageData.isSpriteSheet){this.aHitAreas.push({id:i,callback:z,oData:k,rect:true,area:[Z.aCentrePos[0]-Z.oImageData.oData.spriteHeight/2,Z.aCentrePos[1]-Z.oImageData.oData.spriteHeight/2,Z.aCentrePos[0]+Z.oImageData.oData.spriteWidth/2,Z.aCentrePos[1]+Z.oImageData.oData.spriteHeight/2]});}else{this.aHitAreas.push({id:i,callback:z,oData:k,rect:true,area:[Z.aCentrePos[0]-Z.oImageData.img.width/2,Z.aCentrePos[1]-Z.oImageData.img.height/2,Z.aCentrePos[0]+Z.oImageData.img.width/2,Z.aCentrePos[1]+Z.oImageData.img.height/2]});}break;case "rect":this.aHitAreas.push({id:i,callback:z,oData:k,rect:true,area:Z.aRect});break;}};C.prototype.removeHitArea=function(i){for(var z=0;z<this.aHitAreas.length;z++){if(this.aHitAreas[z].id==i){this.aHitAreas.splice(z,1);z-=1;}}};return C;})();b.UserInput=S;})(Utils||(Utils={}));var Utils;(function(Z){var n=(function(){function k(z){this.updateFreq=10;this.updateInc=0;this.frameAverage=0;this.display=1;this.log="";this.render=function(i){this.frameAverage+=this.delta/this.updateFreq;if(++this.updateInc>=this.updateFreq){this.updateInc=0;this.display=this.frameAverage;this.frameAverage=0;}i.textAlign="left";ctx.font="10px Helvetica";i.fillStyle="#333333";i.beginPath();i.rect(0,this.canvasHeight-15,40,15);i.closePath();i.fill();i.fillStyle="#ffffff";i.fillText(Math.round(1000/(this.display*1000))+" fps "+this.log,5,this.canvasHeight-5);};this.canvasHeight=z;}k.prototype.update=function(i){this.delta=i;};return k;})();Z.FpsMeter=n;})(Utils||(Utils={}));var Elements;(function(n){var C=(function(){function Z(i,z,k){this.oImgData=i;this.canvasWidth=z;this.canvasHeight=k;}Z.prototype.update=function(i){};Z.prototype.render=function(i){i.drawImage(this.oImgData.img,0,0);};return Z;})();n.Background=C;})(Elements||(Elements={}));var Elements;(function(C){var b=(function(){function n(i,z,k,Z){this.incY=0;this.score=0;this.highestScore=0;this.posY=0;this.oScreens=i;this.oButs=z;this.canvasWidth=k;this.canvasHeight=Z;this.posY=-this.canvasHeight;}n.prototype.setRenderFunc=function(i){this.posY=-this.canvasHeight;switch(i){case "start":this.renderFunc=this.renderStartScreen;TweenLite.to(this,.5,{posY:0});break;case "help":break;case "end":break;}};n.prototype.render=function(i,z){this.renderFunc(i,z);};n.prototype.renderStartScreen=function(i,z){this.incY+=5*z;i.drawImage(this.oScreens.startImageData.img,0,0);i.drawImage(this.oButs.play.imageData.img,this.oButs.play.pos[0]-this.oButs.play.imageData.img.width/2,this.oButs.play.pos[1]-this.oButs.play.imageData.img.height/2-Math.sin(this.incY)*5-this.posY);};return n;})();C.Screens=b;})(Elements||(Elements={}));var Elements;(function(n){var C=(function(){function Z(i,z,k){this.inc=0;this.oSplashScreenImgData=i;this.canvasWidth=z;this.canvasHeight=k;this.posY=this.canvasHeight;TweenLite.to(this,.7,{posY:0,ease:"Power2.easeOut"});}Z.prototype.render=function(i,z){i.drawImage(this.oSplashScreenImgData.img,0,this.posY);};return Z;})();n.Splash=C;})(Elements||(Elements={}));var Elements;(function(S){var Q=(function(){function b(i,z,k,Z){this.frameNum=0;this.x=0;this.y=0;this.playerHandTotal1=0;this.playerHandTotal2=0;this.compHandTotal=0;this.letterSpace=17;this.handSide="right";this.oPanelsImgData=i;this.oNumbersImgData=z;this.canvasWidth=k;this.canvasHeight=Z;}b.prototype.setUp=function(i,z){if(typeof z==="undefined"){z=null;}this.type=i;switch(this.type){case "betting":this.aPanels=new Array({id:0,posX:this.canvasWidth/2-this.oPanelsImgData.oData.spriteWidth/2,posY:-160},{id:7,posX:this.canvasWidth,posY:385});this.renderFunc=this.renderInGame;TweenLite.to(this.aPanels[0],.5,{posY:-20});break;case "firstDeal":this.hideDealBut();this.renderFunc=this.renderInGame;TweenLite.to(this.aPanels[0],.5,{posY:-160,onComplete:this.hideDealTweenComplete,onCompleteParams:[this]});if(z.dealType!="blackjack"){this.insuranceIsOn=z.insuranceIsOn;}if(this.insuranceIsOn){this.aPanels.push({id:8,posX:-380,posY:200});TweenLite.to(this.aPanels[this.aPanels.length-1],.5,{posX:-225,delay:1});}this.aPanels.push({id:4,posX:this.canvasWidth,posY:420});this.playerValuePanel1=this.aPanels[this.aPanels.length-1];TweenLite.to(this.aPanels[this.aPanels.length-1],.5,{posX:445,delay:1});this.playerHandTotal1=z.value;if(dealType=="blackjack"){this.actionCompleteCallback=z.callback;TweenLite.to(this.aPanels[this.aPanels.length-1],.5,{posX:445,delay:1,onComplete:this.blackjackDealComplete,onCompleteParams:[this]});}else{TweenLite.to(this.aPanels[this.aPanels.length-1],.5,{posX:445,delay:1});}break;case "newPlayerCard":if(this.handSide=="right"){this.playerHandTotal1=z.value;}else{this.playerHandTotal2=z.value;}for(var k=0;k<this.aPanels.length;k++){if(this.insuranceIsOn&&this.aPanels[k].id==8){TweenLite.to(this.aPanels[k],.5,{posX:-380});}}break;case "newCompCard":this.compHandTotal=z.value;break;case "bust":this.aPanels.push({id:3,posX:this.canvasWidth/2-this.oPanelsImgData.oData.spriteWidth/2,posY:-160});TweenLite.to(this.aPanels[this.aPanels.length-1],1,{posY:213,delay:1,ease:"Back.easeOut"});this.aPanels.push({id:9,posX:this.canvasWidth,posY:385});TweenLite.killTweensOf(this.aPanels[this.aPanels.length-1]);TweenLite.to(this.aPanels[this.aPanels.length-1],.3,{posX:383,delay:2.3});if(this.handSide=="right"){TweenLite.to(this.playerValuePanel1,.3,{posX:this.canvasWidth,delay:2});}if(z.bank<5){this.aPanels.push({id:14,posX:this.canvasWidth/2-this.oPanelsImgData.oData.spriteWidth/2,posY:this.canvasHeight});TweenLite.to(this.aPanels[this.aPanels.length-1],.3,{posY:600,delay:2,ease:"Back.easeOut"});}break;case "blackjack":this.aPanels.push({id:1,posX:this.canvasWidth/2-this.oPanelsImgData.oData.spriteWidth/2,posY:-160});TweenLite.to(this.aPanels[this.aPanels.length-1],1,{posY:213,delay:1,ease:"Elastic.easeOut"});this.aPanels.push({id:9,posX:this.canvasWidth,posY:385});TweenLite.to(this.aPanels[this.aPanels.length-1],.3,{posX:383,delay:2.3});for(var k=0;k<this.aPanels.length;k++){if(this.aPanels[k].id==4){TweenLite.to(this.aPanels[k],.3,{posX:this.canvasWidth,delay:2});break;}}for(var k=0;k<this.aPanels.length;k++){if(this.insuranceIsOn&&this.aPanels[k].id==8){TweenLite.to(this.aPanels[k],.5,{posX:-380});}}break;case "push":this.aPanels.push({id:6,posX:this.canvasWidth/2-this.oPanelsImgData.oData.spriteWidth/2,posY:-160});TweenLite.to(this.aPanels[this.aPanels.length-1],1,{posY:213,delay:1,ease:"Back.easeOut"});this.aPanels.push({id:9,posX:this.canvasWidth,posY:385});TweenLite.to(this.aPanels[this.aPanels.length-1],.3,{posX:383,delay:2.3});for(var k=0;k<this.aPanels.length;k++){if(this.aPanels[k].id==4){TweenLite.to(this.aPanels[k],.3,{posX:this.canvasWidth,delay:2});break;}}for(var k=0;k<this.aPanels.length;k++){if(this.insuranceIsOn&&this.aPanels[k].id==8){TweenLite.to(this.aPanels[k],.5,{posX:-380});}}break;case "compPlay":this.aPanels.push({id:5,posX:this.canvasWidth,posY:80});this.compValuePanel=this.aPanels[this.aPanels.length-1];TweenLite.to(this.aPanels[this.aPanels.length-1],.5,{posX:445,delay:1});this.compHandTotal=z.value;break;case "insuranceTaken":for(var k=0;k<this.aPanels.length;k++){if(this.insuranceIsOn&&this.aPanels[k].id==8){TweenLite.to(this.aPanels[k],.5,{posX:-380});}}break;case "insuranceLose":for(var k=0;k<this.aPanels.length;k++){if(this.insuranceIsOn&&this.aPanels[k].id==8){TweenLite.to(this.aPanels[k],.5,{posX:-380});}}this.aPanels.push({id:13,posX:this.canvasWidth/2-this.oPanelsImgData.oData.spriteWidth/2,posY:-160});TweenLite.to(this.aPanels[this.aPanels.length-1],.5,{posY:-20});break;case "hidePlayOn":for(var k=0;k<this.aPanels.length;k++){if(this.aPanels[k].id==13){TweenLite.to(this.aPanels[k],.5,{posY:-160});}}break;case "insuranceWin":this.aPanels.push({id:10,posX:this.canvasWidth/2-this.oPanelsImgData.oData.spriteWidth/2,posY:-160});TweenLite.to(this.aPanels[this.aPanels.length-1],1,{posY:213,ease:"Back.easeOut"});this.aPanels.push({id:9,posX:this.canvasWidth,posY:385});TweenLite.to(this.aPanels[this.aPanels.length-1],.3,{posX:383,delay:1.3});for(var k=0;k<this.aPanels.length;k++){if(this.aPanels[k].id==4){TweenLite.to(this.aPanels[k],.3,{posX:this.canvasWidth,delay:1});break;}}break;case "playerWin":this.aPanels.push({id:12,posX:this.canvasWidth/2-this.oPanelsImgData.oData.spriteWidth/2,posY:-160});TweenLite.to(this.aPanels[this.aPanels.length-1],1,{posY:213,ease:"Back.easeOut"});this.aPanels.push({id:9,posX:this.canvasWidth,posY:385});TweenLite.to(this.aPanels[this.aPanels.length-1],.3,{posX:383,delay:1.3});for(var k=0;k<this.aPanels.length;k++){if(this.aPanels[k].id==4){TweenLite.to(this.aPanels[k],.3,{posX:this.canvasWidth,delay:1});break;}}break;case "compWin":this.aPanels.push({id:11,posX:this.canvasWidth/2-this.oPanelsImgData.oData.spriteWidth/2,posY:-160});TweenLite.to(this.aPanels[this.aPanels.length-1],1,{posY:213,ease:"Back.easeOut"});this.aPanels.push({id:9,posX:this.canvasWidth,posY:385});TweenLite.to(this.aPanels[this.aPanels.length-1],.3,{posX:383,delay:1.3});for(var k=0;k<this.aPanels.length;k++){if(this.aPanels[k].id==4){TweenLite.to(this.aPanels[k],.3,{posX:this.canvasWidth,delay:1});break;}}if(z.bank<5){this.aPanels.push({id:14,posX:this.canvasWidth/2-this.oPanelsImgData.oData.spriteWidth/2,posY:this.canvasHeight});TweenLite.to(this.aPanels[this.aPanels.length-1],.3,{posY:600,delay:2,ease:"Back.easeOut"});}break;case "compBust":this.aPanels.push({id:2,posX:this.canvasWidth/2-this.oPanelsImgData.oData.spriteWidth/2,posY:-160});TweenLite.to(this.aPanels[this.aPanels.length-1],1,{posY:213,ease:"Back.easeOut"});this.aPanels.push({id:9,posX:this.canvasWidth,posY:385});TweenLite.to(this.aPanels[this.aPanels.length-1],.3,{posX:383,delay:1.3});for(var k=0;k<this.aPanels.length;k++){if(this.aPanels[k].id==4){TweenLite.to(this.aPanels[k],.3,{posX:this.canvasWidth,delay:1});break;}}break;case "split":this.playerHandTotal1=z.playerHandTotal2;this.playerHandTotal2=z.playerHandTotal1;for(var k=0;k<this.aPanels.length;k++){if(this.insuranceIsOn&&this.aPanels[k].id==8){TweenLite.to(this.aPanels[k],.5,{posX:-380});}}TweenLite.to(this.playerValuePanel1,.3,{posX:this.canvasWidth});this.aPanels.push({id:4,posX:-379,posY:420});this.playerValuePanel2=this.aPanels[this.aPanels.length-1];TweenLite.to(this.playerValuePanel2,.3,{posX:-291});this.handSide="left";break;case "switchHands":this.handSide="right";this.actionCompleteCallback=z.callback;TweenLite.to(this.playerValuePanel1,.3,{posX:445,delay:.5,onComplete:this.panelSwitchRight,onCompleteParams:[this]});if(z.event=="bust"){TweenLite.to(this.playerValuePanel2,.3,{posX:-379,delay:.5});}break;}};b.prototype.panelSwitchRight=function(i){i.actionCompleteCallback();};b.prototype.blackjackDealComplete=function(i){i.actionCompleteCallback();};b.prototype.hideDealTweenComplete=function(i){for(var z=0;z<i.aPanels.length;z++){if(i.aPanels[z].id==0||i.aPanels[z].id==7){i.aPanels.splice(z,1);z-=1;}}};b.prototype.showDealBut=function(){TweenLite.killTweensOf(this.aPanels[1]);TweenLite.to(this.aPanels[1],.5,{posX:383});};b.prototype.hideDealBut=function(){TweenLite.killTweensOf(this.aPanels[1]);TweenLite.to(this.aPanels[1],.5,{posX:this.canvasWidth});};b.prototype.render=function(i){this.renderFunc(i);};b.prototype.renderInGame=function(i){for(var z=0;z<this.aPanels.length;z++){var k=(this.aPanels[z].id*this.oPanelsImgData.oData.spriteWidth)%this.oPanelsImgData.img.width,Z=Math.floor(this.aPanels[z].id/(this.oPanelsImgData.img.width/this.oPanelsImgData.oData.spriteWidth))*this.oPanelsImgData.oData.spriteHeight;i.drawImage(this.oPanelsImgData.img,k,Z,this.oPanelsImgData.oData.spriteWidth,this.oPanelsImgData.oData.spriteHeight,this.aPanels[z].posX,this.aPanels[z].posY,this.oPanelsImgData.oData.spriteWidth,this.oPanelsImgData.oData.spriteHeight);}if(this.playerHandTotal1>0){for(var z=0;z<this.playerHandTotal1.toString().length;z++){var n=parseFloat(this.playerHandTotal1.toString().charAt(z)),k=(n*this.oNumbersImgData.oData.spriteWidth)%this.oNumbersImgData.img.width,Z=Math.floor(n/(this.oNumbersImgData.img.width/this.oNumbersImgData.oData.spriteWidth))*this.oNumbersImgData.oData.spriteHeight,C;C=z*this.letterSpace+50-(this.letterSpace*this.playerHandTotal1.toString().length)/2;i.drawImage(this.oNumbersImgData.img,k,Z,this.oNumbersImgData.oData.spriteWidth,this.oNumbersImgData.oData.spriteHeight,this.playerValuePanel1.posX+C,this.playerValuePanel1.posY+60,this.oNumbersImgData.oData.spriteWidth,this.oNumbersImgData.oData.spriteHeight);}}if(this.playerHandTotal2>0){for(var z=0;z<this.playerHandTotal2.toString().length;z++){var n=parseFloat(this.playerHandTotal2.toString().charAt(z)),k=(n*this.oNumbersImgData.oData.spriteWidth)%this.oNumbersImgData.img.width,Z=Math.floor(n/(this.oNumbersImgData.img.width/this.oNumbersImgData.oData.spriteWidth))*this.oNumbersImgData.oData.spriteHeight,C;C=z*this.letterSpace+329-(this.letterSpace*this.playerHandTotal2.toString().length)/2;i.drawImage(this.oNumbersImgData.img,k,Z,this.oNumbersImgData.oData.spriteWidth,this.oNumbersImgData.oData.spriteHeight,this.playerValuePanel2.posX+C,this.playerValuePanel2.posY+60,this.oNumbersImgData.oData.spriteWidth,this.oNumbersImgData.oData.spriteHeight);}}if(this.compHandTotal>0){for(var z=0;z<this.compHandTotal.toString().length;z++){var n=parseFloat(this.compHandTotal.toString().charAt(z)),k=(n*this.oNumbersImgData.oData.spriteWidth)%this.oNumbersImgData.img.width,Z=Math.floor(n/(this.oNumbersImgData.img.width/this.oNumbersImgData.oData.spriteWidth))*this.oNumbersImgData.oData.spriteHeight;i.drawImage(this.oNumbersImgData.img,k,Z,this.oNumbersImgData.oData.spriteWidth,this.oNumbersImgData.oData.spriteHeight,this.compValuePanel.posX+z*this.letterSpace+50-(this.letterSpace*this.compHandTotal.toString().length)/2,this.compValuePanel.posY+60,this.oNumbersImgData.oData.spriteWidth,this.oNumbersImgData.oData.spriteHeight);}}};return b;})();S.Panel=Q;})(Elements||(Elements={}));var Elements;(function(b){var S=(function(){function C(i,z,k){this.bet=0;this.bank=0;this.letterSpace=17;this.oNumbersImgData=i;this.canvasWidth=z;this.canvasHeight=k;}C.prototype.setAmounts=function(i,z){this.bet=i;this.bank=z;};C.prototype.render=function(i){for(var z=0;z<this.bet.toString().length;z++){var k=parseFloat(this.bet.toString().charAt(z)),Z=(k*this.oNumbersImgData.oData.spriteWidth)%this.oNumbersImgData.img.width,n=Math.floor(k/(this.oNumbersImgData.img.width/this.oNumbersImgData.oData.spriteWidth))*this.oNumbersImgData.oData.spriteHeight;i.drawImage(this.oNumbersImgData.img,Z,n,this.oNumbersImgData.oData.spriteWidth,this.oNumbersImgData.oData.spriteHeight,75+z*this.letterSpace,580,this.oNumbersImgData.oData.spriteWidth,this.oNumbersImgData.oData.spriteHeight);}for(var z=0;z<this.bank.toString().length;z++){var k=parseFloat(this.bank.toString().charAt(z)),Z=(k*this.oNumbersImgData.oData.spriteWidth)%this.oNumbersImgData.img.width,n=Math.floor(k/(this.oNumbersImgData.img.width/this.oNumbersImgData.oData.spriteWidth))*this.oNumbersImgData.oData.spriteHeight;i.drawImage(this.oNumbersImgData.img,Z,n,this.oNumbersImgData.oData.spriteWidth,this.oNumbersImgData.oData.spriteHeight,232+z*this.letterSpace,761,this.oNumbersImgData.oData.spriteWidth,this.oNumbersImgData.oData.spriteHeight);}};return C;})();b.Numbers=S;})(Elements||(Elements={}));var Elements;(function(b){var S=(function(){function C(i,z,k,Z,n){this.bet=0;this.bank=0;this.oChipImgData=i;this.chipLevel=z;this.aChipAmounts=k;this.canvasWidth=Z;this.canvasHeight=n;this.aChipStacks=new Array({targX:3,targY:630,x:200,y:800},{targX:133,targY:630,x:200,y:800},{targX:266,targY:630,x:200,y:800},{targX:399,targY:630,x:200,y:800});}C.prototype.setAmounts=function(i,z){this.bet=i;this.bank=z;};C.prototype.updateChipStacks=function(){if(this.bank<this.aChipAmounts[0+this.chipLevel]){this.aChipStacks[0].y=800;this.aChipStacks[1].y=800;this.aChipStacks[2].y=800;this.aChipStacks[3].y=800;}else{this.aChipStacks[0].y=this.aChipStacks[0].targY;if(this.bank<this.aChipAmounts[1+this.chipLevel]){this.aChipStacks[1].y=800;this.aChipStacks[2].y=800;this.aChipStacks[3].y=800;}else{this.aChipStacks[1].y=this.aChipStacks[1].targY;if(this.bank<this.aChipAmounts[2+this.chipLevel]){this.aChipStacks[2].y=800;this.aChipStacks[3].y=800;}else{this.aChipStacks[2].y=this.aChipStacks[2].targY;if(this.bank<this.aChipAmounts[3+this.chipLevel]){this.aChipStacks[3].y=800;}else{this.aChipStacks[3].y=this.aChipStacks[3].targY;}}}}};C.prototype.setUp=function(i){switch(i){case "betting":this.aBetChips=new Array();this.renderFunc=this.renderStart;var z;if(this.bank>=this.aChipAmounts[3+this.chipLevel]){z=4;}else if(this.bank>=this.aChipAmounts[2+this.chipLevel]){z=3;}else if(this.bank>=this.aChipAmounts[1+this.chipLevel]){z=2;}else if(this.bank>=this.aChipAmounts[0+this.chipLevel]){z=1;}for(var k=0;k<z;k++){TweenLite.to(this.aChipStacks[k],.5,{y:this.aChipStacks[k].targY,x:this.aChipStacks[k].targX,ease:"Back.easeOut",delay:k*.1});}break;case "firstDeal":this.renderFunc=this.renderSmall;this.aSmallBetChips=new Array();for(var k=0;k<Math.min(this.aBetChips.length,5);k++){var Z={id:this.aBetChips[this.aBetChips.length-k-1],posX:170+k*(k*3)+1*k,posY:400,scale:1};this.aSmallBetChips.push(Z);TweenLite.killTweensOf(this);TweenLite.to(this.aSmallBetChips[k],.3,{scale:.5,posX:Math.random()*90+190,posY:Math.random()*10+550,delay:k*.1});}for(var k=0;k<this.aChipStacks.length;k++){TweenLite.to(this.aChipStacks[k],.3,{y:800,x:200,delay:k*.1});}break;case "double":this.renderFunc=this.renderDouble;this.aDoubleBetChips=new Array();for(var k=0;k<this.aSmallBetChips.length;k++){var Z={id:this.aSmallBetChips[k].id,posX:200,posY:800,scale:1};this.aDoubleBetChips.push(Z);TweenLite.to(this.aDoubleBetChips[k],.5,{posX:Math.random()*90+190,posY:Math.random()*10+550,ease:"Back.easeOut",delay:.3+k*.1});}break;}};C.prototype.addChip=function(i,z,k){this.setAmounts(z,k);this.updateChipStacks();this.curChipX=this.aChipStacks[i].targX;this.curChipY=this.aChipStacks[i].targY;this.curChipId=i;var Z=Math.min(this.aBetChips.length,4);TweenLite.killTweensOf(this);TweenLite.to(this,.3,{curChipX:170+Z*(Z*3)+1*Z,curChipY:400,ease:"Back.easeOut",onComplete:this.betTweenComplete,onCompleteParams:[this]});this.aBetChips.push(i);this.renderFunc=this.renderAdding;};C.prototype.betTweenComplete=function(i){i.renderFunc=i.renderWaiting;};C.prototype.removeChip=function(i,z){this.setAmounts(i,z);this.updateChipStacks();var k=Math.min(this.aBetChips.length,4);this.curChipX=170+k*(k*3)+1*k;this.curChipY=400;this.curChipId=this.aBetChips[this.aBetChips.length-1];this.aBetChips.pop();TweenLite.killTweensOf(this);TweenLite.to(this,.3,{curChipX:this.aChipStacks[this.curChipId].targX,curChipY:this.aChipStacks[this.curChipId].targY,ease:"Back.easeIn",onComplete:this.betTweenComplete,onCompleteParams:[this]});this.renderFunc=this.renderRemoving;};C.prototype.render=function(i){this.renderFunc(i);};C.prototype.renderStart=function(i){for(var z=0;z<this.aChipStacks.length;z++){var k=((z+this.chipLevel)*this.oChipImgData.oData.spriteWidth)%this.oChipImgData.img.width,Z=Math.floor((z+this.chipLevel)/(this.oChipImgData.img.width/this.oChipImgData.oData.spriteWidth))*this.oChipImgData.oData.spriteHeight;i.drawImage(this.oChipImgData.img,k,Z,this.oChipImgData.oData.spriteWidth,this.oChipImgData.oData.spriteHeight,this.aChipStacks[z].x,this.aChipStacks[z].y,this.oChipImgData.oData.spriteWidth,this.oChipImgData.oData.spriteHeight);}};C.prototype.renderAdding=function(i){for(var z=0;z<this.aChipStacks.length;z++){var k=((z+this.chipLevel)*this.oChipImgData.oData.spriteWidth)%this.oChipImgData.img.width,Z=Math.floor((z+this.chipLevel)/(this.oChipImgData.img.width/this.oChipImgData.oData.spriteWidth))*this.oChipImgData.oData.spriteHeight;i.drawImage(this.oChipImgData.img,k,Z,this.oChipImgData.oData.spriteWidth,this.oChipImgData.oData.spriteHeight,this.aChipStacks[z].x,this.aChipStacks[z].y,this.oChipImgData.oData.spriteWidth,this.oChipImgData.oData.spriteHeight);}for(var z=0;z<Math.min(this.aBetChips.length-1,4);z++){var n=this.aBetChips[this.aBetChips.length-1-Math.min(this.aBetChips.length-1,4)+z]+this.chipLevel,k=(n*this.oChipImgData.oData.spriteWidth)%this.oChipImgData.img.width,Z=Math.floor(n/(this.oChipImgData.img.width/this.oChipImgData.oData.spriteWidth))*this.oChipImgData.oData.spriteHeight;i.drawImage(this.oChipImgData.img,k,Z,this.oChipImgData.oData.spriteWidth,this.oChipImgData.oData.spriteHeight,170+z*(z*3)+1*z,400,this.oChipImgData.oData.spriteWidth,this.oChipImgData.oData.spriteHeight);}var k=((this.curChipId+this.chipLevel)*this.oChipImgData.oData.spriteWidth)%this.oChipImgData.img.width,Z=Math.floor((this.curChipId+this.chipLevel)/(this.oChipImgData.img.width/this.oChipImgData.oData.spriteWidth))*this.oChipImgData.oData.spriteHeight;i.drawImage(this.oChipImgData.img,k,Z,this.oChipImgData.oData.spriteWidth,this.oChipImgData.oData.spriteHeight,this.curChipX,this.curChipY,this.oChipImgData.oData.spriteWidth,this.oChipImgData.oData.spriteHeight);};C.prototype.renderRemoving=function(i){for(var z=0;z<this.aChipStacks.length;z++){var k=((z+this.chipLevel)*this.oChipImgData.oData.spriteWidth)%this.oChipImgData.img.width,Z=Math.floor((z+this.chipLevel)/(this.oChipImgData.img.width/this.oChipImgData.oData.spriteWidth))*this.oChipImgData.oData.spriteHeight;i.drawImage(this.oChipImgData.img,k,Z,this.oChipImgData.oData.spriteWidth,this.oChipImgData.oData.spriteHeight,this.aChipStacks[z].x,this.aChipStacks[z].y,this.oChipImgData.oData.spriteWidth,this.oChipImgData.oData.spriteHeight);}for(var z=0;z<Math.min(this.aBetChips.length,4);z++){var n=this.aBetChips[this.aBetChips.length-Math.min(this.aBetChips.length,4)+z]+this.chipLevel,k=(n*this.oChipImgData.oData.spriteWidth)%this.oChipImgData.img.width,Z=Math.floor(n/(this.oChipImgData.img.width/this.oChipImgData.oData.spriteWidth))*this.oChipImgData.oData.spriteHeight;i.drawImage(this.oChipImgData.img,k,Z,this.oChipImgData.oData.spriteWidth,this.oChipImgData.oData.spriteHeight,170+z*(z*3)+1*z,400,this.oChipImgData.oData.spriteWidth,this.oChipImgData.oData.spriteHeight);}var k=((this.curChipId+this.chipLevel)*this.oChipImgData.oData.spriteWidth)%this.oChipImgData.img.width,Z=Math.floor((this.curChipId+this.chipLevel)/(this.oChipImgData.img.width/this.oChipImgData.oData.spriteWidth))*this.oChipImgData.oData.spriteHeight;i.drawImage(this.oChipImgData.img,k,Z,this.oChipImgData.oData.spriteWidth,this.oChipImgData.oData.spriteHeight,this.curChipX,this.curChipY,this.oChipImgData.oData.spriteWidth,this.oChipImgData.oData.spriteHeight);};C.prototype.renderWaiting=function(i){for(var z=0;z<this.aChipStacks.length;z++){var k=((z+this.chipLevel)*this.oChipImgData.oData.spriteWidth)%this.oChipImgData.img.width,Z=Math.floor((z+this.chipLevel)/(this.oChipImgData.img.width/this.oChipImgData.oData.spriteWidth))*this.oChipImgData.oData.spriteHeight;i.drawImage(this.oChipImgData.img,k,Z,this.oChipImgData.oData.spriteWidth,this.oChipImgData.oData.spriteHeight,this.aChipStacks[z].x,this.aChipStacks[z].y,this.oChipImgData.oData.spriteWidth,this.oChipImgData.oData.spriteHeight);}for(var z=0;z<Math.min(this.aBetChips.length,5);z++){var n=this.aBetChips[this.aBetChips.length-Math.min(this.aBetChips.length,5)+z]+this.chipLevel,k=(n*this.oChipImgData.oData.spriteWidth)%this.oChipImgData.img.width,Z=Math.floor(n/(this.oChipImgData.img.width/this.oChipImgData.oData.spriteWidth))*this.oChipImgData.oData.spriteHeight;i.drawImage(this.oChipImgData.img,k,Z,this.oChipImgData.oData.spriteWidth,this.oChipImgData.oData.spriteHeight,170+z*(z*3)+1*z,400,this.oChipImgData.oData.spriteWidth,this.oChipImgData.oData.spriteHeight);}};C.prototype.renderSmall=function(i){for(var z=0;z<this.aChipStacks.length;z++){var k=((z+this.chipLevel)*this.oChipImgData.oData.spriteWidth)%this.oChipImgData.img.width,Z=Math.floor((z+this.chipLevel)/(this.oChipImgData.img.width/this.oChipImgData.oData.spriteWidth))*this.oChipImgData.oData.spriteHeight;i.drawImage(this.oChipImgData.img,k,Z,this.oChipImgData.oData.spriteWidth,this.oChipImgData.oData.spriteHeight,this.aChipStacks[z].x,this.aChipStacks[z].y,this.oChipImgData.oData.spriteWidth,this.oChipImgData.oData.spriteHeight);}for(var z=0;z<this.aSmallBetChips.length;z++){var n=this.aSmallBetChips[z].id+this.chipLevel,k=(n*this.oChipImgData.oData.spriteWidth)%this.oChipImgData.img.width,Z=Math.floor(n/(this.oChipImgData.img.width/this.oChipImgData.oData.spriteWidth))*this.oChipImgData.oData.spriteHeight;i.drawImage(this.oChipImgData.img,k,Z,this.oChipImgData.oData.spriteWidth,this.oChipImgData.oData.spriteHeight,this.aSmallBetChips[z].posX,this.aSmallBetChips[z].posY,this.oChipImgData.oData.spriteWidth*this.aSmallBetChips[z].scale,this.oChipImgData.oData.spriteHeight*this.aSmallBetChips[z].scale);}};C.prototype.renderDouble=function(i){for(var z=0;z<this.aSmallBetChips.length;z++){var k=this.aSmallBetChips[z].id+this.chipLevel,Z=(k*this.oChipImgData.oData.spriteWidth)%this.oChipImgData.img.width,n=Math.floor(k/(this.oChipImgData.img.width/this.oChipImgData.oData.spriteWidth))*this.oChipImgData.oData.spriteHeight;i.drawImage(this.oChipImgData.img,Z,n,this.oChipImgData.oData.spriteWidth,this.oChipImgData.oData.spriteHeight,this.aSmallBetChips[z].posX,this.aSmallBetChips[z].posY,this.oChipImgData.oData.spriteWidth*this.aSmallBetChips[z].scale,this.oChipImgData.oData.spriteHeight*this.aSmallBetChips[z].scale);}for(var z=0;z<this.aDoubleBetChips.length;z++){var k=this.aDoubleBetChips[z].id+this.chipLevel,Z=(k*this.oChipImgData.oData.spriteWidth)%this.oChipImgData.img.width,n=Math.floor(k/(this.oChipImgData.img.width/this.oChipImgData.oData.spriteWidth))*this.oChipImgData.oData.spriteHeight;i.drawImage(this.oChipImgData.img,Z,n,this.oChipImgData.oData.spriteWidth,this.oChipImgData.oData.spriteHeight,this.aDoubleBetChips[z].posX,this.aDoubleBetChips[z].posY,this.oChipImgData.oData.spriteWidth*this.aSmallBetChips[z].scale,this.oChipImgData.oData.spriteHeight*this.aSmallBetChips[z].scale);}};return C;})();b.Chips=S;})(Elements||(Elements={}));var Elements;(function(b){var S=(function(){function C(i,z,k){this.centreId=0;this.oCardsImgData=i;this.canvasWidth=z;this.canvasHeight=k;}C.prototype.setUp=function(i,z){if(typeof z==="undefined"){z=null;}switch(i){case "firstDeal":this.aPlayerCards1=new Array();this.aPlayerCards2=new Array();this.aCurPlayerCards=this.aPlayerCards1;this.aCompCards=new Array();this.aCurPlayerCards.push({id:z.aPlayerDealtCards[0].id,posX:200,posY:-200,rotation:0});this.aCurPlayerCards.push({id:z.aPlayerDealtCards[1].id,posX:200,posY:-200,rotation:0});this.aCompCards.push({id:z.aCompDealtCards[0].id,posX:200,posY:-200,rotation:0,scaleX:1});this.aCompCards.push({id:52,posX:200,posY:-200,rotation:0,scaleX:1});for(var k=0;k<this.aCurPlayerCards.length;k++){var Z=this.getCentreX(k,this.aCurPlayerCards.length,this.centreId);TweenLite.to(this.aCurPlayerCards[k],1,{rotation:this.getRotation(Z),posX:this.getCentreX(k,this.aCurPlayerCards.length,this.centreId),posY:460,delay:k*.1});var Z=this.getCentreX(k,this.aCompCards.length,this.centreId);TweenLite.to(this.aCompCards[k],1,{rotation:this.getRotation(Z),posX:this.getCentreX(k,this.aCompCards.length,this.centreId),posY:130,delay:k*.1+.2});}break;case "newPlayerCard":this.aCurPlayerCards.push({id:z.newCard.id,posX:200,posY:-200,rotation:0});for(var k=0;k<this.aCurPlayerCards.length;k++){var Z=this.getCentreX(k,this.aCurPlayerCards.length,this.centreId);if(z.callback&&k==this.aCurPlayerCards.length-1){this.actionCompleteCallback=z.callback;TweenLite.to(this.aCurPlayerCards[k],1,{rotation:this.getRotation(Z),posX:Z,posY:460,onComplete:this.handComplete,onCompleteParams:[this]});break;}TweenLite.to(this.aCurPlayerCards[k],1,{rotation:this.getRotation(Z),posX:Z,posY:460});}break;case "newCompCard":this.centreId=0;this.aCompCards.push({id:z.oNewCard.id,posX:200,posY:-200,rotation:0,scaleX:1});for(var k=0;k<this.aCompCards.length;k++){var Z=this.getCentreX(k,this.aCompCards.length,this.centreId);if(z.callback&&k==this.aCompCards.length-1){this.actionCompleteCallback=z.callback;TweenLite.to(this.aCompCards[k],1,{rotation:this.getRotation(Z),posX:Z,posY:130,onComplete:this.handComplete,onCompleteParams:[this]});break;}TweenLite.to(this.aCompCards[k],1,{rotation:this.getRotation(Z),posX:Z,posY:130});}break;case "compPlay":this.centreId=0;TweenLite.to(this.aCompCards[1],.5,{scaleX:0,ease:"Power1.easeIn"});this.aCompCards.push({id:z.oHoleCard.id,posX:this.aCompCards[1].posX,posY:this.aCompCards[1].posY,rotation:this.aCompCards[1].rotation,scaleX:0});TweenLite.to(this.aCompCards[2],.5,{scaleX:1,delay:.5,onComplete:this.holeCardRevealComplete,onCompleteParams:[this]});this.actionCompleteCallback=z.callback;break;case "compShow":this.centreId=0;TweenLite.to(this.aCompCards[1],.5,{scaleX:0,ease:"Power1.easeIn"});this.aCompCards.push({id:z.oHoleCard.id,posX:this.aCompCards[1].posX,posY:this.aCompCards[1].posY,rotation:this.aCompCards[1].rotation,scaleX:0});TweenLite.to(this.aCompCards[2],.5,{scaleX:1,delay:.5});break;case "compInsuranceShow":this.centreId=0;TweenLite.to(this.aCompCards[1],.5,{scaleX:0,ease:"Power1.easeIn"});this.aCompCards.push({id:z.oHoleCard.id,posX:this.aCompCards[1].posX,posY:this.aCompCards[1].posY,rotation:this.aCompCards[1].rotation,scaleX:0});TweenLite.to(this.aCompCards[2],.5,{scaleX:1,delay:.5,onComplete:this.holeCardRevealComplete,onCompleteParams:[this]});this.actionCompleteCallback=z.callback;break;case "split":this.aPlayerCards2=new Array(this.aPlayerCards1.pop());this.centreId=1;var Z=this.getCentreX(0,this.aCurPlayerCards.length,1);TweenLite.to(this.aCurPlayerCards[0],.5,{rotation:this.getRotation(Z),posX:Z});var Z=this.getCentreX(0,this.aPlayerCards2.length,2);TweenLite.to(this.aPlayerCards2[0],.5,{rotation:this.getRotation(Z),posX:Z});break;case "switchHands":this.centreId=2;this.aCurPlayerCards=this.aPlayerCards2;break;}};C.prototype.handComplete=function(i){i.actionCompleteCallback();};C.prototype.holeCardRevealComplete=function(i){for(var z=0;z<i.aCompCards.length;z++){if(i.aCompCards[z].id==52){i.aCompCards.splice(z,1);}}i.actionCompleteCallback();};C.prototype.getCentreX=function(i,z,k){if(typeof k==="undefined"){k=0;}var Z=this.canvasWidth/2,n=50;if(k==1){Z=this.canvasWidth/4;n=25;}else if(k==2){Z=(this.canvasWidth/4)*3;n=25;}return Z+i*n-((z-1)*n)/2;};C.prototype.getRotation=function(i){return ((Math.PI/8)/this.canvasWidth)*i-(Math.PI/16);};C.prototype.render=function(i){for(var z=0;z<this.aCompCards.length;z++){i.save();i.translate(this.aCompCards[z].posX,this.aCompCards[z].posY);i.rotate(this.aCompCards[z].rotation);var k=this.aCompCards[z].id,Z=(k*this.oCardsImgData.oData.spriteWidth)%this.oCardsImgData.img.width,n=Math.floor(k/(this.oCardsImgData.img.width/this.oCardsImgData.oData.spriteWidth))*this.oCardsImgData.oData.spriteHeight;i.drawImage(this.oCardsImgData.img,Z,n,this.oCardsImgData.oData.spriteWidth,this.oCardsImgData.oData.spriteHeight,-this.oCardsImgData.oData.spriteWidth/2+(1-this.aCompCards[z].scaleX)*(this.oCardsImgData.oData.spriteWidth/2),-this.oCardsImgData.oData.spriteHeight/2,this.oCardsImgData.oData.spriteWidth*this.aCompCards[z].scaleX,this.oCardsImgData.oData.spriteHeight);i.restore();}for(var z=0;z<this.aPlayerCards1.length;z++){i.save();ctx.translate(this.aPlayerCards1[z].posX,this.aPlayerCards1[z].posY);ctx.rotate(this.aPlayerCards1[z].rotation);var k=this.aPlayerCards1[z].id,Z=(k*this.oCardsImgData.oData.spriteWidth)%this.oCardsImgData.img.width,n=Math.floor(k/(this.oCardsImgData.img.width/this.oCardsImgData.oData.spriteWidth))*this.oCardsImgData.oData.spriteHeight;i.drawImage(this.oCardsImgData.img,Z,n,this.oCardsImgData.oData.spriteWidth,this.oCardsImgData.oData.spriteHeight,-this.oCardsImgData.oData.spriteWidth/2,-this.oCardsImgData.oData.spriteHeight/2,this.oCardsImgData.oData.spriteWidth,this.oCardsImgData.oData.spriteHeight);i.restore();}for(var z=0;z<this.aPlayerCards2.length;z++){i.save();ctx.translate(this.aPlayerCards2[z].posX,this.aPlayerCards2[z].posY);ctx.rotate(this.aPlayerCards2[z].rotation);var k=this.aPlayerCards2[z].id,Z=(k*this.oCardsImgData.oData.spriteWidth)%this.oCardsImgData.img.width,n=Math.floor(k/(this.oCardsImgData.img.width/this.oCardsImgData.oData.spriteWidth))*this.oCardsImgData.oData.spriteHeight;i.drawImage(this.oCardsImgData.img,Z,n,this.oCardsImgData.oData.spriteWidth,this.oCardsImgData.oData.spriteHeight,-this.oCardsImgData.oData.spriteWidth/2,-this.oCardsImgData.oData.spriteHeight/2,this.oCardsImgData.oData.spriteWidth,this.oCardsImgData.oData.spriteHeight);i.restore();}};return C;})();b.Cards=S;})(Elements||(Elements={}));var Elements;(function(C){var b=(function(){function n(i,z,k){this.canHit=false;this.oButtonsImgData=i;this.canvasWidth=z;this.canvasHeight=k;this.aButs=new Array({targX:3,targY:630,x:200,y:800,isOn:true},{targX:133,targY:630,x:200,y:800,isOn:true},{targX:266,targY:630,x:200,y:800,isOn:true},{targX:399,targY:630,x:200,y:800,isOn:true});}n.prototype.setUp=function(i,z){if(typeof z==="undefined"){z=null;}switch(i){case "firstDeal":if(z.dealType=="blackjack"){return ;}if(z.dealType=="normal"){this.aButs[0].isOn=false;}if(!z.doubleIsOn){this.aButs[1].isOn=false;}for(var k=0;k<this.aButs.length;k++){if(this.aButs[k].isOn){TweenLite.to(this.aButs[k],.5,{y:this.aButs[k].targY,x:this.aButs[k].targX,ease:"Back.easeOut",delay:1+k*.1,onComplete:this.allowButs,onCompleteParams:[this]});}}break;case "double":case "stand":for(var k=0;k<this.aButs.length;k++){if(this.aButs[k].isOn){TweenLite.to(this.aButs[k],.3,{y:800,x:200,delay:k*.1});}}break;case "split":case "hit":for(var k=0;k<2;k++){if(this.aButs[k].isOn){TweenLite.to(this.aButs[k],.3,{y:800,x:200,delay:k*.1});}}break;case "bust":case "insuranceWin":for(var k=0;k<this.aButs.length;k++){if(this.aButs[k].isOn){TweenLite.to(this.aButs[k],.3,{y:800,x:200,delay:1+k*.1});}}break;}};n.prototype.allowButs=function(i){i.canHit=true;};n.prototype.render=function(i){for(var z=0;z<this.aButs.length;z++){if(this.aButs[z].isOn){var k=(z*this.oButtonsImgData.oData.spriteWidth)%this.oButtonsImgData.img.width,Z=Math.floor(z/(this.oButtonsImgData.img.width/this.oButtonsImgData.oData.spriteWidth))*this.oButtonsImgData.oData.spriteHeight;i.drawImage(this.oButtonsImgData.img,k,Z,this.oButtonsImgData.oData.spriteWidth,this.oButtonsImgData.oData.spriteHeight,this.aButs[z].x,this.aButs[z].y,this.oButtonsImgData.oData.spriteWidth,this.oButtonsImgData.oData.spriteHeight);}}};return n;})();C.Buttons=b;})(Elements||(Elements={}));var requestAnimFrame=(function(){return window.requestAnimationFrame||(window).webkitRequestAnimationFrame||(window).mozRequestAnimationFrame||(window).oRequestAnimationFrame||window.msRequestAnimationFrame||function(i){window.setTimeout(i,1000/60,new Date().getTime());};})(),previousTime,canvas=document.getElementById('canvas'),ctx=canvas.getContext("2d");canvas.width=533;canvas.height=800;var canvasX,canvasY,canvasScaleX,canvasScaleY,div=document.getElementById('viewporter'),sound,music,allowSound=false,muted=false,splash,splashTimer=0,screens,assetLib,preAssetLib,rotatePause=false,manualPause=false,isMobile=false,gameState="loading",aLangs=new Array("EN","ES"),curLang="",isBugBrowser=false,isIE10=false,ios9FirstTouch=false;if(navigator.userAgent.match(/MSIE\s([\d]+)/)){isIE10=true;}var deviceAgent=navigator.userAgent.toLowerCase();if(deviceAgent.match(/(iphone|ipod|ipad)/)||deviceAgent.match(/(android)/)||deviceAgent.match(/(iemobile)/)||deviceAgent.match(/iphone/i)||deviceAgent.match(/ipad/i)||deviceAgent.match(/ipod/i)||deviceAgent.match(/blackberry/i)||deviceAgent.match(/bada/i)){isMobile=true;if(deviceAgent.match(/(android)/)&&!/Chrome/.test(navigator.userAgent)){isBugBrowser=true;}}var userInput=new Utils.UserInput(canvas,isBugBrowser);resizeCanvas();window.onresize=function(){setTimeout(function(){resizeCanvas();},1);};function visibleResume(){if(!muted&&!manualPause){Howler.unmute();}}function visiblePause(){Howler.mute();}window.addEventListener("load",function(){setTimeout(function(){resizeCanvas();},0);window.addEventListener("orientationchange",function(){setTimeout(function(){resizeCanvas();},500);},false);});if(!isIE10&&(typeof (window).AudioContext!=='undefined'||typeof (window).webkitAudioContext!=='undefined'||navigator.userAgent.indexOf('Android')==-1)){allowSound=true;sound=new Howl({urls:['audio/sound.ogg','audio/sound.m4a'],sprite:{click:[0,150],cardHard:[250,500],chip:[1000,300],bust:[1500,750],win:[2500,750],blackjack:[3500,750],push:[4500,750],cardSoft:[5500,300],chipIntro:[6000,500],silence:[150,100]}});}var panel,background,bet=0,bank=0,numbers,chips,aChipAmounts=new Array(5,10,25,100,500,1000),cards,aDeck,dealType,buttons,aPCards1,aPCards2,aCurPlayerCards,aCompCards,insuranceTaken=false,splitTaken=false,insuranceCard,chipLevel=0;loadPreAssets();function initSplash(){gameState="splash";resizeCanvas();splash=new Elements.Splash(assetLib.getData("splash"),canvas.width,canvas.height);previousTime=new Date().getTime();updateSplashScreenEvent();}function resetDeck(){aDeck=new Array();for(var i=0;i<52;i++){aDeck.push({id:i,value:i%13+1});}}function initStartScreen(){gameState="start";if(allowSound){}bet=0;bank=1000;userInput.addHitArea("mute",butEventHandler,null,{type:"rect",aRect:[455,0,canvas.width,75]},true);userInput.addHitArea("help",butEventHandler,null,{type:"rect",aRect:[0,0,80,75]},true);var i=new Array(canvas.width/2,600);screens=new Elements.Screens({startImageData:assetLib.getData("titleScreen")},{play:{imageData:assetLib.getData("playBut"),pos:i}},canvas.width,canvas.height);screens.setRenderFunc("start");userInput.addHitArea("startGame",butEventHandler,i,{type:"image",oImageData:assetLib.getData("playBut"),aCentrePos:i});previousTime=new Date().getTime();updateStartScreenEvent();}function initBetting(){gameState="betting";insuranceTaken=false;if(bank<2000){chipLevel=0;}else if(bank<10000){chipLevel=1;}else{chipLevel=2;}if(allowSound){}playSound("chipIntro");userInput.addHitArea("quitGameBetting",butEventHandler,null,{type:"rect",aRect:[0,0,80,75]},true);userInput.addHitArea("addChip",butEventHandler,{id:0},{type:"rect",aRect:[0,630,133,758]});userInput.addHitArea("addChip",butEventHandler,{id:1},{type:"rect",aRect:[133,630,266,758]});userInput.addHitArea("addChip",butEventHandler,{id:2},{type:"rect",aRect:[266,630,399,758]});userInput.addHitArea("addChip",butEventHandler,{id:3},{type:"rect",aRect:[399,630,533,758]});userInput.addHitArea("removeChip",butEventHandler,null,{type:"rect",aRect:[170,390,360,530]});userInput.addHitArea("deal",butEventHandler,null,{type:"rect",aRect:[390,390,canvas.width,530]});background=new Elements.Background(assetLib.getData("background"),canvas.width,canvas.height);numbers=new Elements.Numbers(assetLib.getData("numbers"),canvas.width,canvas.height);numbers.setAmounts(bet,bank);panel=new Elements.Panel(assetLib.getData("panels"),assetLib.getData("numbers"),canvas.width,canvas.height);panel.setUp("betting");chips=new Elements.Chips(assetLib.getData("chips"),chipLevel,aChipAmounts,canvas.width,canvas.height);chips.setAmounts(bet,bank);chips.setUp("betting");previousTime=new Date().getTime();updateBettingEvent();}function initHelp(){gameState="help";userInput.addHitArea("quitHelp",butEventHandler,null,{type:"rect",aRect:[0,0,80,75]},true);ctx.drawImage(assetLib.getData("helpScreen").img,0,0);}function initDeal(){gameState="dealing";resetDeck();playSound("cardHard");userInput.addHitArea("quitGameDealing",butEventHandler,null,{type:"rect",aRect:[0,0,80,75]},true);userInput.addHitArea("hit",butEventHandler,null,{type:"rect",aRect:[266,630,399,758]});userInput.addHitArea("stand",butEventHandler,null,{type:"rect",aRect:[399,630,533,758]});aPCards2=new Array();aPCards1=aCurPlayerCards=getCards(2);aCompCards=getCards(1);if((roundToTen(this.aCurPlayerCards[0].value)+roundToTen(this.aCurPlayerCards[1].value))==11&&(this.aCurPlayerCards[0].value==1||this.aCurPlayerCards[1].value==1)){dealType="blackjack";}else if(roundToTen(this.aCurPlayerCards[0].value)==roundToTen(this.aCurPlayerCards[1].value)&&bank>=bet){dealType="split";userInput.addHitArea("split",butEventHandler,null,{type:"rect",aRect:[0,630,133,758]});}else{dealType="normal";}var i=false,z=false;if(aCompCards[0].value==1&&bank>=bet){userInput.addHitArea("insure",butEventHandler,null,{type:"rect",aRect:[0,200,150,350]});i=true;}if(bank>=bet){userInput.addHitArea("double",butEventHandler,null,{type:"rect",aRect:[133,630,266,758]});z=true;}panel.setUp("firstDeal",{dealType:dealType,insuranceIsOn:i,value:getBestValue(this.aCurPlayerCards),callback:initBlackjackCompare});cards=new Elements.Cards(assetLib.getData("cards"),canvas.width,canvas.height);cards.setUp("firstDeal",{aPlayerDealtCards:this.aCurPlayerCards,aCompDealtCards:this.aCompCards,dealType:dealType});chips.setUp("firstDeal");previousTime=new Date().getTime();buttons=new Elements.Buttons(assetLib.getData("buttons"),canvas.width,canvas.height);buttons.setUp("firstDeal",{dealType:dealType,doubleIsOn:z});updateDealingEvent();}function initBlackjackCompare(){var i=getCards(1)[0];aCompCards.push(i);panel.setUp("compPlay",{value:getBestValue(aCompCards)});cards.setUp("compPlay",{oHoleCard:i,callback:checkBlackjack});}function initCompPlay(){var i;if(!insuranceTaken){i=getCards(1)[0];}else{i=insuranceCard;}aCompCards.push(i);playSound("cardSoft");panel.setUp("compPlay",{value:getBestValue(aCompCards)});cards.setUp("compPlay",{oHoleCard:i,callback:checkHands});}function dealNewCompCard(){var i=getCards(1)[0];aCompCards.push(i);playSound("cardSoft");panel.setUp("newCompCard",{value:getBestValue(aCompCards)});cards.setUp("newCompCard",{oNewCard:i,callback:checkHands});}function initCompShow(){var i=getCards(1)[0];aCompCards.push(i);playSound("cardSoft");cards.setUp("compShow",{oHoleCard:i});}function initCompInsuranceShow(){aCompCards.push(insuranceCard);playSound("cardSoft");panel.setUp("compPlay",{value:getBestValue(aCompCards)});cards.setUp("compInsuranceShow",{oHoleCard:insuranceCard,callback:checkInsuranceHand});}function checkInsuranceHand(){var i=getBestValue(aCompCards);if(i==21){bank+=Math.round(bet*1.5);bet=0;numbers.setAmounts(bet,bank);userInput.removeHitArea("split");userInput.removeHitArea("double");userInput.removeHitArea("hit");userInput.removeHitArea("stand");panel.setUp("insuranceWin");buttons.setUp("insuranceWin");userInput.addHitArea("replay",butEventHandler,null,{type:"rect",aRect:[390,390,canvas.width,530]});}else{buttons.canHit=true;}}function checkHands(){var i=getBestValue(aCompCards),z=getBestValue2(aPCards1,aPCards2);if(i>21){panel.setUp("compBust");playSound("win");bank+=bet*2;bet=0;numbers.setAmounts(bet,bank);userInput.removeHitArea("split");userInput.removeHitArea("double");userInput.removeHitArea("hit");userInput.removeHitArea("stand");userInput.addHitArea("replay",butEventHandler,null,{type:"rect",aRect:[390,390,canvas.width,530]});}else if(i>16){if(i>z){panel.setUp("compWin",{bank:bank});playSound("bust");if(bank<5){bank=1000;}bet=0;numbers.setAmounts(bet,bank);userInput.removeHitArea("split");userInput.removeHitArea("double");userInput.removeHitArea("hit");userInput.removeHitArea("stand");userInput.addHitArea("replay",butEventHandler,null,{type:"rect",aRect:[390,390,canvas.width,530]});}else if(i<z){panel.setUp("playerWin");playSound("win");bank+=bet*2;bet=0;numbers.setAmounts(bet,bank);userInput.removeHitArea("split");userInput.removeHitArea("double");userInput.removeHitArea("hit");userInput.removeHitArea("stand");userInput.addHitArea("replay",butEventHandler,null,{type:"rect",aRect:[390,390,canvas.width,530]});}else{panel.setUp("push");playSound("push");bank+=bet;bet=0;numbers.setAmounts(bet,bank);userInput.removeHitArea("split");userInput.removeHitArea("double");userInput.removeHitArea("hit");userInput.removeHitArea("stand");userInput.addHitArea("replay",butEventHandler,null,{type:"rect",aRect:[390,390,canvas.width,530]});}}else{dealNewCompCard();}}function checkBlackjack(){var i=getBestValue(aCompCards);if(i==21){console.log("push");panel.setUp("push");playSound("push");bank+=bet;bet=0;numbers.setAmounts(bet,bank);userInput.removeHitArea("split");userInput.removeHitArea("double");userInput.removeHitArea("hit");userInput.removeHitArea("stand");userInput.addHitArea("replay",butEventHandler,null,{type:"rect",aRect:[390,390,canvas.width,530]});}else{panel.setUp("blackjack");playSound("blackjack");bank+=bet+Math.round(bet*=1.5);bet=0;numbers.setAmounts(bet,bank);userInput.removeHitArea("split");userInput.removeHitArea("double");userInput.removeHitArea("hit");userInput.removeHitArea("stand");userInput.addHitArea("replay",butEventHandler,null,{type:"rect",aRect:[390,390,canvas.width,530]});}}function roundToTen(i){if(i>10){i=10;}return i;}function getBestValue(i){var z=0,k=0;for(var Z=0;Z<i.length;Z++){if(i[Z].value==1){k++;z+=11;}else{z+=roundToTen(i[Z].value);}}if(z>21){for(var Z=0;Z<k;Z++){z-=10;if(z<=21){break;}}}return z;}function getBestValue2(i,z){var k=getBestValue(i),Z=getBestValue(z);if(k>22){return Z;}else if(Z>22){return k;}else{if(k>Z){return k;}else{return Z;}}}function getCards(i){var z=new Array();for(var k=0;k<i;k++){if(aDeck.length>0){var Z=Math.floor(Math.random()*aDeck.length);z.push(aDeck[Z]);aDeck.splice(Z,1);}else{break;}}return z;}function dealNewPlayerCard(i){if(typeof i==="undefined"){i=false;}var z=getCards(1)[0];aCurPlayerCards.push(z);panel.setUp("newPlayerCard",{value:getBestValue(aCurPlayerCards)});if(getBestValue(aCurPlayerCards)>21){if(!splitTaken){if(getBestValue(aPCards1)>21){panel.setUp("bust",{bank:bank});if(bank<5){bank=1000;}buttons.setUp("bust");chips.setUp("bust");playSound("bust");bet=0;numbers.setAmounts(bet,bank);userInput.removeHitArea("split");userInput.removeHitArea("double");userInput.removeHitArea("hit");userInput.removeHitArea("stand");userInput.addHitArea("replay",butEventHandler,null,{type:"rect",aRect:[390,390,canvas.width,530]});cards.setUp("newPlayerCard",{newCard:z,callback:initCompShow});}else{userInput.removeHitArea("split");userInput.removeHitArea("double");userInput.removeHitArea("hit");userInput.removeHitArea("stand");buttons.setUp("stand");panel.setUp("stand");initCompPlay();}}else{splitTaken=false;cards.setUp("newPlayerCard",{newCard:z});panel.setUp("switchHands",{callback:dealNewPlayerCard,event:"bust"});bet/=2;numbers.setAmounts(bet,bank);cards.setUp("switchHands");aCurPlayerCards=aPCards2;}}else if(i){cards.setUp("newPlayerCard",{newCard:z,callback:initCompPlay});}else{cards.setUp("newPlayerCard",{newCard:z});}}function butEventHandler(i,z){switch(i){case "langSelect":curLang=z.lang;ctx.clearRect(0,0,canvas.width,canvas.height);userInput.removeHitArea("langSelect");initLoadAssets();break;case "replay":playSound("click");userInput.removeHitArea("replay");userInput.removeHitArea("quitGameDealing");bet=0;numbers.setAmounts(bet,bank);initBetting();break;case "split":if(buttons.canHit){playSound("click");splitTaken=true;aPCards2=new Array();aPCards2.push(aCurPlayerCards.pop());aPCards1=aCurPlayerCards;bank-=bet;bet*=2;numbers.setAmounts(bet,bank);userInput.removeHitArea("split");userInput.removeHitArea("double");buttons.setUp("split");cards.setUp("split");dealNewPlayerCard();panel.setUp("split",{playerHandTotal1:getBestValue(aPCards1),playerHandTotal2:getBestValue(aPCards2)});if(insuranceTaken){panel.setUp("hidePlayOn");}}break;case "double":if(buttons.canHit){playSound("cardSoft");bank-=bet;bet*=2;userInput.removeHitArea("split");userInput.removeHitArea("double");userInput.removeHitArea("hit");userInput.removeHitArea("stand");numbers.setAmounts(bet,bank);buttons.setUp("double");chips.setUp("double");dealNewPlayerCard(true);if(insuranceTaken){panel.setUp("hidePlayOn");}}break;case "hit":if(buttons.canHit){playSound("cardSoft");userInput.removeHitArea("split");userInput.removeHitArea("double");buttons.setUp("hit");dealNewPlayerCard();if(insuranceTaken){panel.setUp("hidePlayOn");}}break;case "stand":if(buttons.canHit){playSound("click");if(!splitTaken){userInput.removeHitArea("split");userInput.removeHitArea("double");userInput.removeHitArea("hit");userInput.removeHitArea("stand");buttons.setUp("stand");panel.setUp("stand");initCompPlay();}else{splitTaken=false;panel.setUp("switchHands",{callback:dealNewPlayerCard});cards.setUp("switchHands");aCurPlayerCards=aPCards2;}if(insuranceTaken){panel.setUp("hidePlayOn");}}break;case "startGame":playSound("click");userInput.removeHitArea("startGame");userInput.removeHitArea("help");if(isMobile){launchFullscreen(document.documentElement);}initBetting();break;case "help":playSound("click");userInput.removeHitArea("startGame");userInput.removeHitArea("help");initHelp();break;case "quitHelp":playSound("click");userInput.removeHitArea("quitHelp");initStartScreen();break;case "mute":playSound("click");toggleMute();break;case "quitGameBetting":playSound("click");userInput.removeHitArea("quitGameBetting");userInput.removeHitArea("addChip");userInput.removeHitArea("removeChip");userInput.removeHitArea("deal");initStartScreen();break;case "quitGameDealing":playSound("click");userInput.removeHitArea("quitGameDealing");userInput.removeHitArea("split");userInput.removeHitArea("double");userInput.removeHitArea("hit");userInput.removeHitArea("stand");userInput.removeHitArea("insure");userInput.removeHitArea("replay");initStartScreen();break;case "addChip":if(aChipAmounts[z.id]<=bank){playSound("chip");panel.showDealBut();bet+=aChipAmounts[z.id+chipLevel];bank-=aChipAmounts[z.id+chipLevel];numbers.setAmounts(bet,bank);chips.addChip(z.id,bet,bank);}break;case "removeChip":if(bet>=5){playSound("click");bet-=aChipAmounts[chips.aBetChips[chips.aBetChips.length-1]+chipLevel];bank+=aChipAmounts[chips.aBetChips[chips.aBetChips.length-1]+chipLevel];numbers.setAmounts(bet,bank);chips.removeChip(bet,bank);if(bet<=0){panel.hideDealBut();}}break;case "deal":if(bet>0){playSound("click");userInput.removeHitArea("quitGameBetting");userInput.removeHitArea("addChip");userInput.removeHitArea("removeChip");userInput.removeHitArea("deal");initDeal();}break;case "insure":playSound("click");insuranceCard=getCards(1)[0];bank-=Math.round(bet/2);numbers.setAmounts(bet,bank);insuranceTaken=true;if(roundToTen(insuranceCard.value)==10){panel.setUp("insuranceTaken");initCompInsuranceShow();buttons.canHit=false;}else{panel.setUp("insuranceLose");}break;}}function updateDealingEvent(){if(rotatePause||gameState!="dealing"){return ;}var i=getDelta();background.render(ctx);numbers.render(ctx);chips.render(ctx);cards.render(ctx);buttons.render(ctx);panel.render(ctx);renderMuteBut();requestAnimFrame(updateDealingEvent);}function updateBettingEvent(){if(rotatePause||gameState!="betting"){return ;}var i=getDelta();background.render(ctx);numbers.render(ctx);chips.render(ctx);panel.render(ctx);renderMuteBut();requestAnimFrame(updateBettingEvent);}function updateSplashScreenEvent(){if(rotatePause||gameState!="splash"){return ;}var i=getDelta();splashTimer+=i;if(splashTimer>2.5){initStartScreen();return ;}splash.render(ctx,i);requestAnimFrame(updateSplashScreenEvent);}function updateStartScreenEvent(){if(rotatePause||gameState!="start"){return ;}var i=getDelta();screens.render(ctx,i);renderMuteBut();requestAnimFrame(updateStartScreenEvent);}function getDelta(){var i=new Date().getTime(),z=(i-previousTime)/1000;previousTime=i;if(z>.5){z=0;}return z;}function renderSprite(i){ctx.save();ctx.translate(i.x,i.y);ctx.rotate(i.rotation);i.render(ctx);ctx.restore();}function loadPreAssets(){if(aLangs.length>1){preAssetLib=new Utils.AssetLoader(curLang,[{id:"langSelect",file:"images/langSelect.jpg"},{id:"preloadImage",file:"images/preloadImage.jpg"}],ctx,canvas.width,canvas.height,false);preAssetLib.onReady(initLangSelect);}else{curLang=aLangs[0];preAssetLib=new Utils.AssetLoader(curLang,[{id:"preloadImage",file:"images/preloadImage.jpg"}],ctx,canvas.width,canvas.height,false);preAssetLib.onReady(initLoadAssets);}}function initLangSelect(){var i=preAssetLib.getData("langSelect");ctx.drawImage(i.img,canvas.width/2-i.img.width/2,canvas.height/2-i.img.height/2);var z=140;for(var k=0;k<aLangs.length;k++){var Z=canvas.width/2-(z*aLangs.length)/2+k*z,n=canvas.height/2-z/2;userInput.addHitArea("langSelect",butEventHandler,{lang:aLangs[k]},{type:"rect",aRect:[Z,n,Z+z,n+140]});}}function initLoadAssets(){var i=preAssetLib.getData("preloadImage");ctx.drawImage(i.img,canvas.width/2-i.img.width/2,canvas.height/2-i.img.height-10);loadAssets();}function loadAssets(){assetLib=new Utils.AssetLoader(curLang,[{id:"background",file:"images/"+curLang+"/background.jpg"},{id:"helpScreen",file:"images/"+curLang+"/helpScreen.jpg"},{id:"titleScreen",file:"images/titleScreen.jpg"},{id:"rotateDeviceMessage",file:"images/rotateDeviceMessage.jpg"},{id:"splash",file:"images/splashScreen.jpg"},{id:"playBut",file:"images/"+curLang+"/playBut.png"},{id:"panels",file:"images/"+curLang+"/panels_379x159.png",oData:{columns:4,spriteWidth:379,spriteHeight:159}},{id:"numbers",file:"images/numbers_17x36.png",oData:{columns:3,spriteWidth:17,spriteHeight:36}},{id:"cards",file:"images/cards_128x173.png",oData:{columns:9,spriteWidth:128,spriteHeight:173}},{id:"buttons",file:"images/"+curLang+"/buttons_131x133.png",oData:{columns:4,spriteWidth:131,spriteHeight:133}},{id:"chips",file:"images/chips_133x133.png",oData:{columns:2,spriteWidth:133,spriteHeight:133}},{id:"muteBut",file:"images/mute_68x67.png",oData:{columns:2,spriteWidth:68,spriteHeight:67}}],ctx,canvas.width,canvas.height);if(allowSound&&!muted){}assetLib.onReady(initSplash);}function resizeCanvas(){var i=window.innerWidth,z=window.innerHeight;if(i>480){i-=1;z-=1;}if(window.innerWidth>window.innerHeight&&isMobile){if(gameState!="loading"){rotatePauseOn();}if(i/canvas.width<z/canvas.height){canvas.style.width=i+"px";canvas.style.height=(i/canvas.width)*canvas.height+"px";canvasX=0;canvasY=((z-(i/canvas.width)*canvas.height)/2);canvasScaleX=canvasScaleY=canvas.width/i;div.style.marginTop=canvasY+"px";div.style.marginLeft=canvasX+"px";}else{canvas.style.width=(z/canvas.height)*canvas.width+"px";canvas.style.height=z+"px";canvasX=((i-(z/canvas.height)*canvas.width)/2);canvasY=0;canvasScaleX=canvasScaleY=canvas.height/z;div.style.marginTop=canvasY+"px";div.style.marginLeft=canvasX+"px";}}else if(!isMobile){if(rotatePause){rotatePauseOff();}if(i/canvas.width<z/canvas.height){canvas.style.width=i+"px";canvas.style.height=(i/canvas.width)*canvas.height+"px";canvasX=0;canvasY=((z-(i/canvas.width)*canvas.height)/2);canvasScaleX=canvasScaleY=canvas.width/i;div.style.marginTop=canvasY+"px";div.style.marginLeft=canvasX+"px";}else{canvas.style.width=(z/canvas.height)*canvas.width+"px";canvas.style.height=z+"px";canvasX=((i-(z/canvas.height)*canvas.width)/2);canvasY=0;canvasScaleX=canvasScaleY=canvas.height/z;div.style.marginTop=canvasY+"px";div.style.marginLeft=canvasX+"px";}}else{if(rotatePause){rotatePauseOff();}canvasX=canvasY=0;canvasScaleX=canvas.width/i;canvasScaleY=canvas.height/z;canvas.style.width=i+"px";canvas.style.height=z+"px";div.style.marginTop=0+"px";div.style.marginLeft=0+"px";}userInput.setCanvas(canvasX,canvasY,canvasScaleX,canvasScaleY);}function playSound(i){if(allowSound){sound.play(i);}}function toggleMute(){muted=!muted;if(allowSound){if(muted){Howler.mute();}else{Howler.unmute();}}renderMuteBut();}function renderMuteBut(){if(!allowSound){return ;}var i=assetLib.getData("muteBut"),z=0;if(muted){z=1;}var k=(z*i.oData.spriteWidth)%i.img.width,Z=Math.floor(z/(i.img.width/i.oData.spriteWidth))*i.oData.spriteHeight;ctx.drawImage(i.img,k,Z,i.oData.spriteWidth,i.oData.spriteHeight,459,6,i.oData.spriteWidth,i.oData.spriteHeight);}function toggleManualPause(){if(!manualPause){manualPause=true;if(allowSound){Howler.mute();}pauseCoreOn();}else{manualPause=false;if(allowSound){if(!muted){Howler.unmute();}}pauseCoreOff();}}function rotatePauseOn(){rotatePause=true;ctx.drawImage(assetLib.getImg("rotateDeviceMessage"),0,0);pauseCoreOn();}function rotatePauseOff(){rotatePause=false;pauseCoreOff();}function pauseCoreOn(){userInput.pauseIsOn=true;switch(gameState){case "start":break;case "betting":break;case "dealing":break;}}function pauseCoreOff(){previousTime=new Date().getTime();userInput.pauseIsOn=false;switch(gameState){case "splash":updateSplashScreenEvent();break;case "start":initStartScreen();break;case "help":initHelp();break;case "betting":updateBettingEvent();break;case "dealing":updateDealingEvent();break;}};